---
name: get-status
on:
  push:
  workflow_dispatch:

jobs:
  set-config:
    runs-on: ubuntu-latest
    outputs:
      confJson: ${{ steps.set-config.outputs.confJson }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Set configuration
        id: set-config
        run: |
          cat config.json | tr -d '\n' | jq -c
          list=$(cat config.json | tr -d '\n' | jq -c)
          echo "confJson=${list}" >> $GITHUB_OUTPUT       

  get-status:
    needs: set-config
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        repo: ${{fromJson(needs.set-config.outputs.confJson).repository}}
    steps:
      - name: Get pr-created-date
        run: |
          echo ${{ matrix.repo }}
          ./tools/get-pr-created-date.sh 500 ${{ matrix.repo }} ${{ secrets.GIT_PAT }}
